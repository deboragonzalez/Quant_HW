---
title: "Homework 8"
author: "Debi Gonzalez"
date: "2025-11-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(mosaic)

cbcl <- read.csv("cbcl_data.csv")
```


1)	Using a t.test(), examine whether Child Behavior Checklist (CBCL) anxiety scores are different, on average, between males and females. For this question, first state the null and alternate hypothesis. Then conduct the appropriate test in R (using the suggested command). Print the command and the output. Then state the conclusion based on the test result.

Null Hypothesis: Male Anxiety mean == Female Anxiety mean  
The mean CBCL anxiety score for males equals the mean CBCL anxiety score for females.

Alternate Hypothesis:  Male Anxiety mean =/= Female Anxiety mean  
The mean CBCL anxiety score differs between males and females.

Test: Two Independent Samples

```{r}

# Independent samples t-test comparing CBCL anxiety scores by sex
mosaic::t.test(cbcl_anxiety_t ~ birthsex, data = cbcl)

```

Conclusion: Because p > .05, we fail to reject the null hypothesis. There is no statistically significant difference in average CBCL anxiety scores between males and females.
A Welch two-sample t-test indicated that CBCL anxiety T-scores did not differ significantly between females (M = 53.32) and males (M = 54.40), t(96.88) = –0.88, p = .38. We therefore fail to reject the null hypothesis.


2)	Using a t.test(), examine whether CBCL anxiety scores are different, on average, from the clinical cutoff of 69. Are these children significantly more anxious than the standard cutoff? For this question, first state the null and alternate hypothesis. Then conduct the appropriate test in R (using the suggested command). Print the command and the output. Then state the conclusion based on the test result.

Null Hypothesis: Sample Mean == 69  
The mean CBCL anxiety score for males equals the mean CBCL anxiety score for females.

Alternate Hypothesis:  Sample mean =/= 69  
The mean CBCL anxiety score differs between males and females.

Test: One Sample T-Test


```{r}

# One sample t-test, using the clinical cutoff as the mean to compare it to:
t.test(cbcl$cbcl_anxiety_t, mu = 69) 
```
Conclusion: Because p < .05, we reject the null hypothesis. There is a statistically significant difference in average CBCL anxiety scores in this sample and the clinical cutoff of 69. Participants’ CBCL anxiety T-scores are significantly lower than 69, on average. The actual sample mean is around 53.9, and the entire confidence interval lies well below 69. This provides strong evidence that the true anxiety level in your sample is not only different from 69—it's much lower.

3)	Is there an association between age in months and CBCL anxiety scores? One way to answer this question is to conduct a linear regression. The command in R is lm(), which stands for linear model. For this question, there is no need to state the null and alternate hypothesis, and no need to state a conclusion.

Try putting the model into an object, and then summary() the object. Then plot the graph as below.
 
library(car)
model1 <- lm(cbcl_anxiety_t ~ agemonths, data = cbcl_data)
summary(model1)
avPlots(model1)

Print the output here (the summary and the plot). Ignore the intercept for now. Note the output for agemonths has 1) an estimate (in this case, it is the slope of the regression line); 2) a standard error of the estimate; 3) a t value; 4) a p value. 

Now, 
a) take the value of the slope and subtract zero from the that value (i.e., slope – 0). Print that value here. This shows how different the slope is from zero (i.e., is it different from a flat line having no slope? The null hypothesis would be that the slope (B) = 0); 
b) Take that difference score and divide it by the standard error from the output. Print that value here. 
c) Compare that value to the t statistic from the output. Are they the same or different?


4)	Using a t.test(), examine whether Child Behavior Checklist (CBCL) anxiety scores are different, on average, between males and females, but this time turn off the Welch correction (put var.equal = TRUE). You can just paste the R command and output here (no need to state the null hypothesis etc.).

```{r}

# Independent samples t-test comparing CBCL anxiety scores by sex with "equal variances"; ommiting the Welch correction

mosaic::t.test(cbcl_anxiety_t ~ birthsex, data = cbcl, var.equal = TRUE)
```

5)	Now try examining the same hypothesis for question 4, but this time use the linear model. The command is:

model2 <- lm(cbcl_anxiety_t ~ birthsex, data = cbcl_data)
summary(model2)
avPlots(model2)

Paste the R output here. 

First examine the plot. Compare that plot to the one examining age in months as the predictor. Note the predictor is categorical for birth sex, whereas age in months is continuous.

Now, compare the linear model output with the output in question 4. Specifically, compare:

a)	Calculate the mean difference for males and females from the t.test() output. Compare that with the value of the slope from the linear model. Print both here.
b)	Compare the t value and p value from the t.test() output to the t value and p value from the linear model output. Print both here.
c)	Take the square root of the F-statistic from the linear model output. Compare it to the t value from both the t.test() and the linear model output. Print all three here.
d)	Compare the group differences between males and females on the CBCL anxiety scores using an Analysis of Variance (ANOVA). The command in R is aov() and uses the same formula interface you have been using.

So, paste the following into R:

model3 <- aov(cbcl_anxiety_t ~ birthsex, data = cbcl_data)
summary(model3)

Compare the F and p values for the ANOVA with the F and p values from the linear model. Print both here.

6)	Now, using the same logic, conduct an ANOVA, but this time instead of birth sex, use age group as the predictor. Is there a statistically significant difference among the age groups for CBCL anxiety scores? Print your conclusion and the R output here.

7)	Finally, conduct the same analysis as in 6), but use the linear model. Print the output and the plot here.

